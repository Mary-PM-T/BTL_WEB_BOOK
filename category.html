<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="home.css">
    <style>

        .main-frame {
            display: flex;
            gap: 20px;
            padding: 20px 0;
            flex-wrap: wrap;
            background-color:#F0F8FF;
        }
        .left {
            flex: 1;
            max-width: 28%;
            border-right: 2px solid #97ceff;
            padding-right: 20px;
        }
        .right {
            flex: 2;
            max-width: 70%;    
            margin-right: 8px;
        }

        /*=========== MENU BOOK ===========*/
        .Menu-Book {
            background-color: white;
            margin-bottom: 20px;
            font-weight: bold;
            border-radius: 5px;
            border: 1.5px solid #9ae4ff;
        }

        .MB-titles {
            background: linear-gradient(135deg, #4384a8 0%, #4460ab 100%);
            font-size: 1.6rem;
            color: white;
            height: 60px;
            line-height: 60px;
            padding-left: 15px;
        }

        .Menu-Book a {
            display: block;
            color: #3553a7;
            font-size: 1.2rem;
            padding: 10px 25px;
            text-decoration: none;
            transition: all 0.3s ease;
            margin-right: 5px;
        }

        .Menu-Book a:hover {
            background: linear-gradient(135deg, #87CEEB 0%, #5DADE2 100%);
            border-radius: 7px;
            color: white;
            transform: translateX(3px);
            box-shadow: 0 3px 12px rgba(135, 206, 235, 0.3);
        }

        /*=========== SLIDER ===========*/
        .slider-img {
            width: 100%;
            height: 250px;
            background: #eefcff;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border-radius: 7px;
            position: relative;
        }

        .show-pic {
            width: 98%;
            height: 95%;
            position: relative;
            overflow: hidden;
            border-radius: 6px;
        }

        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .slide.active {
            opacity: 1;
        }

        /*=========== SELECT TITLE ===========*/
        .select {
            background: linear-gradient(135deg, #ff7777 0%, #ff5252 100%);
            padding: 5px 15px;
            font-weight: bold;
            font-size: 22px;
            border-radius: 7px;
            color: white;
            margin: 15px 5px;
        }
        /*=========== FILTER FORM ===========*/
        .filter-form {
            background: white;
            border: 1.5px solid #9ae4ff;
            border-radius: 7px;
            padding: 20px;
            margin: 15px 5px;
            box-shadow: 0 2px 8px rgba(135, 206, 235, 0.15);
        }

        .filter-title {
            background: linear-gradient(135deg, #4384a8 0%, #4460ab 100%);
            color: white;
            font-size: 1.4rem;
            font-weight: bold;
            padding: 10px 15px;
            margin: -20px -20px 15px -20px;
            border-radius: 5px 5px 0 0;
        }

        .filter-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: end;
            margin-bottom: 15px;
        }

        .filter-group {
            flex: 1;
            min-width: 150px;
        }

        .filter-group label {
            display: block;
            font-weight: bold;
            color: #3553a7;
            margin-bottom: 5px;
            font-size: 0.95rem;
        }

        .filter-group select,
        .filter-group input {
            width: 100%;
            padding: 8px 12px;
            border: 1.5px solid #87CEEB;
            border-radius: 5px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: white;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #4384a8;
            box-shadow: 0 0 5px rgba(67, 132, 168, 0.3);
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-filter,
        .btn-reset {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .btn-filter {
            background: linear-gradient(135deg, #4384a8 0%, #4460ab 100%);
            color: white;
        }

        .btn-filter:hover {
            background: linear-gradient(135deg, #3a7596 0%, #3c5499 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(67, 132, 168, 0.3);
        }

        .btn-reset {
            background: linear-gradient(135deg, #ff7777 0%, #ff5252 100%);
            color: white;
        }

        .btn-reset:hover {
            background: linear-gradient(135deg, #e66565 0%, #e64747 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 119, 119, 0.3);
        }

        .filter-results {
            margin: 10px 5px;
            padding: 10px;
            background: #f0f8ff;
            border-left: 4px solid #4384a8;
            border-radius: 0 5px 5px 0;
            font-weight: bold;
            color: #3553a7;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .filter-row {
                flex-direction: column;
            }
            
            .filter-group {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
    <!--------- HEADER --------->
    <header>
        <div class="l">
            <div class="logo"><p>BTL.SACH</p></div>
            <span class="sTC"><a href="Home.html">Trang ch·ªß</a></span>
        </div>

        <div class="r">
            <div class="search">
                <input type="text" id="searchInput" placeholder="Nh·∫≠p t√™n s√°ch">
                <button class="search-nut" onclick="searchBook()">T√¨m ki·∫øm</button>
            </div>

            <div class="icon-group">
                <a href="Cart.html" style="text-decoration: none; color: inherit;">
                    <i class="fa fa-shopping-cart"></i><span> üõí </span>
                </a>

                <!-- N√∫t ch·ªçn ng√¥n ng·ªØ -->
                <div id="togg" class="lang-button">
                    <img id="selectedFlag" src="https://flagcdn.com/w40/vn.png" alt="VN" class="flag-icon">
                </div>

                <!-- Menu c·ªù -->
                <div id="nation" class="lang-select hidden">
                    <ul>
                        <li><img src="https://flagcdn.com/w40/vn.png" alt="VN" onclick="selectFlag('vn')"></li>
                        <li><img src="https://flagcdn.com/w40/us.png" alt="US" onclick="selectFlag('us')"></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <!--------- MAIN-FRAME --------->
        <div class="main-frame">
            <div class="left">
                <!--------- list book --------->
                <div class="Menu-Book">
                    <div class="MB-titles">Danh m·ª•c s·∫£n ph·∫©m</div>
                    <a href="category.html?category=kinh-te" data-category="Book-KT">S√°ch kinh t·∫ø</a>
                    <a href="category.html?category=van-hoc" data-category="Book-VH">S√°ch vƒÉn h·ªçc</a>
                    <a href="category.html?category=thieu-nhi" data-category="Book-TN">S√°ch thi·∫øu nhi</a>
                    <a href="category.html?category=ki-nang" data-category="Book-KN">S√°ch kƒ© nƒÉng</a>
                    <a href="category.html?category=tam-ly" data-category="Book-TL">S√°ch t√¢m l√Ω</a>
                    <a href="category.html?category=giao-khoa" data-category="Book-GK">S√°ch gi√°o khoa</a>
                    <a href="category.html?category=thinh-hanh" data-category="Book-TTT">Top th·ªãnh h√†nh</a>
                    <a href="category.html?category=moi-2025" data-category="BookNew">S√°ch m·ªõi 2025</a>
                </div>

                <!--------- selection contents --------->
                <div>
                    <div class="select">Combo S√°ch hot</div>
                    <div class="book-f1">
                        <div class="book-f1-one">
                            <div><img src="images/combo1.webp" alt="S√°ch 1"></div>
                            <div>
                                <div class="book-f1-info">
                                    <h3 class="book-f1-title">Combo 3 cu·ªën: N∆°i Khu R·ª´ng Ch·∫°m T·ªõi Nh·ªØng V√¨ Sao + Nh·ªØng Cung ƒê∆∞·ªùng D∆∞·ªõi B·∫ßu Tr·ªùi Sao + N·∫Øng Xuy√™n Qua V√≤m L√°</h3>
                                    <p class="book-f1-author">T√°c gi·∫£: Glendy‚ÄØVanderah</p>
                                    <div class="book-f1-info">
                                        <p class="book-f1-price">Gi√°: 412.000ƒë</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="book-f1">
                        <div class="book-f1-one">
                            <div><img src="images/combo2+.webp" alt="S√°ch 2"></div>
                            <div>
                                <div class="book-f1-info">
                                    <h3 class="book-f1-title">Combo Gia ƒë√¨nh t·ªânh th·ª©c + Cha m·∫π t·ªânh th·ª©c</h3>
                                    <p class="book-f1-author">T√°c gi·∫£: Shefali Tsabary</p>
                                    <div class="book-f1-info">
                                        <p class="book-f1-price">Gi√°: 223.680ƒë</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="book-f1">
                        <div class="book-f1-one">
                            <div><img src="images/combo3.webp" alt="S√°ch 3"></div>
                            <div>
                                <div class="book-f1-info">
                                    <h3 class="book-f1-title">S√°ch: Combo 4 Cu·ªën Khi B·∫°n ƒêang M∆° + V∆∞∆°n L√™n Ho·∫∑c B·ªã ƒê√°nh B·∫°i + M·ªói L·∫ßn V·∫•p Ng√£ + Kh√¥ng Ph·∫£i Thi·∫øu May M·∫Øn</h3>
                                    <p class="book-f1-author">T√°c gi·∫£: nhi·ªÅu T√°c Gi·∫£</p>
                                    <div class="book-f1-info">
                                        <p class="book-f1-price">Gi√°: 392.270ƒë</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--------- ---------- --------->
            <div class="right">
                <div class="book-f2-frame">
                    <div class="select" id="category-title"></div>
                    <!--L·ªåC S√ÅCH THEO T√ÅC GI·∫¢ + M·ª®C GI√Å-->
                    <div class="filter-form">
                        <div class="filter-title">üîç L·ªçc s√°ch</div>
                        
                        <div class="filter-row">
                            <div class="filter-group">
                                <label for="author-filter">T√°c gi·∫£:</label>
                                <input type="text" id="author-filter" placeholder="Nh·∫≠p t√™n t√°c gi·∫£...">
                            </div>
                            
                            <div class="filter-group">
                                <label for="price-range-filter">Kho·∫£ng gi√°:</label>
                                <select id="price-range-filter">
                                    <option value="">-- T·∫•t c·∫£ m·ª©c gi√° --</option>
                                    <option value="0-100000">D∆∞·ªõi 100.000ƒë</option>
                                    <option value="100000-200000">100.000ƒë - 200.000ƒë</option>
                                    <option value="200000-300000">200.000ƒë - 300.000ƒë</option>
                                    <option value="300000-500000">300.000ƒë - 500.000ƒë</option>
                                    <option value="500000-700000">500.000ƒë - 700.000ƒë</option>
                                    <option value="700000-1000000">700.000ƒë - 1.000.000ƒë</option>
                                    <option value="1000000-99999999">Tr√™n 1.000.000ƒë</option>
                                </select>
                            </div>
                        </div> 
                        
                        <div class="filter-buttons">
                            <button class="btn-filter" onclick="applyFilters()">√Åp d·ª•ng b·ªô l·ªçc</button>
                            <button class="btn-reset" onclick="resetFilters()">X√≥a b·ªô l·ªçc</button>
                        </div>
                    </div>  <!--L·ªåC S√ÅCH THEO T√ÅC GI·∫¢ + M·ª®C GI√Å-->

                    <div class="book-f2" id="book-container"></div>
                </div>
            </div>
        </div> <!--MAIN FRAME-->
        

    </div> <!--CONTAINER-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="Full.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const books = JSON.parse(localStorage.getItem("books")) || {};

        const categoryMap = {
            'kinh-te': 'Book-KT',
            'van-hoc': 'Book-VH',
            'thieu-nhi': 'Book-TN',
            'ki-nang': 'Book-KN',
            'tam-ly': 'Book-TL',
            'giao-khoa': 'Book-GK',
            'thinh-hanh': 'Book-TTT',
            'moi-2025': 'BookNew'
        };

        const categoryTitles = {
            'Book-KT': 'S√°ch kinh t·∫ø',
            'Book-VH': 'S√°ch vƒÉn h·ªçc',
            'Book-TN': 'S√°ch thi·∫øu nhi',
            'Book-KN': 'S√°ch kƒ© nƒÉng',
            'Book-TL': 'S√°ch t√¢m l√Ω',
            'Book-GK': 'S√°ch gi√°o khoa',
            'Book-TTT': 'Top th·ªãnh h√†nh',
            'BookNew': 'S√°ch m·ªõi 2025'
        };

        const urlParams = new URLSearchParams(window.location.search);
        const categoryParam = urlParams.get("category");
        const categoryKey = categoryMap[categoryParam];

        if (!categoryKey || !books[categoryKey]) {
            document.getElementById("book-container").innerHTML = "<p>Kh√¥ng t√¨m th·∫•y th·ªÉ lo·∫°i ho·∫∑c ch∆∞a c√≥ d·ªØ li·ªáu.</p>";
            return;
        }

        // C·∫≠p nh·∫≠t ti√™u ƒë·ªÅ
        const titleEl = document.getElementById("category-title");
        if (titleEl) titleEl.textContent = categoryTitles[categoryKey] || "Danh m·ª•c s√°ch";

        // T·∫°o container ƒë√∫ng ID ƒë·ªÉ renderBooks nh·∫≠n
        const containerRoot = document.getElementById("book-container");
        containerRoot.innerHTML = ""; // X√≥a n·ªôi dung c≈©

        const newContainer = document.createElement("div");
        newContainer.id = categoryKey;
        containerRoot.appendChild(newContainer);

        // G·ªçi renderBooks nh∆∞ ƒë√£ thi·∫øt k·∫ø
        renderBooks(categoryKey, books[categoryKey]);

        // K√≠ch ho·∫°t tr·∫°ng th√°i "active" cho danh m·ª•c ƒëang ch·ªçn
        document.querySelectorAll('.Menu-Book a').forEach(link => {
            link.classList.remove('active');
            if (link.dataset.category === categoryKey) {
                link.classList.add('active');
            }
        });
    });
    // Kh·ªüi t·∫°o form l·ªçc (kh√¥ng c·∫ßn thi·∫øt cho input text)
    function initializeAuthorFilter() {
        // Input text kh√¥ng c·∫ßn kh·ªüi t·∫°o dropdown
        // Ch·ªâ c·∫ßn reset gi√° tr·ªã v·ªÅ r·ªóng
        document.getElementById('author-filter').value = '';
    }

    // √Åp d·ª•ng b·ªô l·ªçc
    function applyFilters() {
        const authorInput = document.getElementById('author-filter').value.toLowerCase().trim();
        const priceRange = document.getElementById('price-range-filter').value;
        
        // X·ª≠ l√Ω kho·∫£ng gi√°
        let minPrice = 0;
        let maxPrice = Infinity;
        
        if (priceRange) {
            const [min, max] = priceRange.split('-').map(p => parseFloat(p));
            minPrice = min;
            maxPrice = max;
        }
        
        filteredBooks = originalBooks.filter(book => {
            // L·ªçc theo t√°c gi·∫£ (t√¨m ki·∫øm c√≥ ch·ª©a)
            const authorMatch = !authorInput || 
                (book.author && book.author.toLowerCase().includes(authorInput));
            
            // L·ªçc theo gi√°
            const bookPrice = parseFloat(book.price?.toString().replace(/[^\d]/g, '')) || 0;
            const priceMatch = bookPrice >= minPrice && bookPrice <= maxPrice;
            
            return authorMatch && priceMatch;
        });
        
        // Hi·ªÉn th·ªã k·∫øt qu·∫£ l·ªçc
        showFilterResults();
        
        // Render l·∫°i s√°ch ƒë√£ l·ªçc
        const container = document.getElementById(currentCategory);
        if (container) {
            container.innerHTML = '';
        }
        renderBooks(currentCategory, filteredBooks);
    }

    // Reset b·ªô l·ªçc
    function resetFilters() {
        document.getElementById('author-filter').value = '';
        document.getElementById('price-range-filter').value = '';
        
        filteredBooks = [...originalBooks];
        
        // ·∫®n th√¥ng b√°o k·∫øt qu·∫£ l·ªçc
        document.getElementById('filter-results').style.display = 'none';
        
        // Render l·∫°i t·∫•t c·∫£ s√°ch
        const container = document.getElementById(currentCategory);
        if (container) {
            container.innerHTML = '';
        }
        renderBooks(currentCategory, filteredBooks);
    }

    // Hi·ªÉn th·ªã k·∫øt qu·∫£ l·ªçc
    function showFilterResults() {
        const resultsDiv = document.getElementById('filter-results');
        const totalBooks = originalBooks.length;
        const filteredCount = filteredBooks.length;
        
        if (filteredCount === totalBooks) {
            resultsDiv.style.display = 'none';
        } else {
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = `üìä Hi·ªÉn th·ªã ${filteredCount} trong t·ªïng s·ªë ${totalBooks} cu·ªën s√°ch`;
        }
    }

    // H√†m renderBooks gi·∫£ ƒë·ªãnh (b·∫°n c·∫ßn thay th·∫ø b·∫±ng h√†m th·ª±c t·∫ø t·ª´ Full.js)
    function renderBooks(categoryId, books) {
        // N·∫øu h√†m renderBooks ƒë√£ c√≥ s·∫µn t·ª´ Full.js, ch·ªâ c·∫ßn g·ªçi n√≥
        // N·∫øu ch∆∞a c√≥, ƒë√¢y l√† m·ªôt implementation c∆° b·∫£n:
        
        const container = document.getElementById(categoryId);
        if (!container || !books) return;
        
        container.innerHTML = '';
        
        books.forEach((book, index) => {
            const bookElement = document.createElement('div');
            bookElement.className = 'book-item';
            bookElement.innerHTML = `
                <div class="book-card">
                    <img src="${book.image || 'images/default-book.jpg'}" alt="${book.title}" style="width: 100%; height: 200px; object-fit: cover;">
                    <h3>${book.title}</h3>
                    <p>T√°c gi·∫£: ${book.author || 'Kh√¥ng r√µ'}</p>
                    <p>Gi√°: ${book.price || 'Li√™n h·ªá'}</p>
                </div>
            `;
            container.appendChild(bookElement);
        });
        
        if (books.length === 0) {
            container.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">Kh√¥ng t√¨m th·∫•y s√°ch ph√π h·ª£p v·ªõi b·ªô l·ªçc.</p>';
        }
    }
</script>
</body>
</html>
